# AGENT.md: 에피아이 (Epi-i) 프로젝트

## 1\. 프로젝트 목표 및 핵심 컨셉

**Project Goal:** 뇌전증 아동의 보호자가 발작 증상과 생활 패턴을 체계적이고 객관적으로 기록하도록 돕는다. 이를 통해 축적된 데이터를 의료진과의 상담 시 정확한 정보로 제공하여, 아동의 치료 계획 수립에 기여하는 것을 목표로 한다.

**Core Concept:** `객관적인 발작 기록`과 `생활 습관과의 연관성 분석`

\<br\>

## 2\. 페르소나 (Agents)

### **Primary Agent: 보호자 (부모)**

  * **Goals:**
      * 아이가 발작을 일으켰을 때, 당황하지 않고 정확한 정보를 기록하고 싶다.
      * 의사에게 아이의 상태를 말로만 설명하는 것의 한계를 느끼며, 객관적인 데이터를 보여주고 싶다.
      * 어떤 상황(수면 부족, 특정 음식 등)이 발작에 영향을 미치는지 패턴을 찾고 싶다.
      * 매일 먹여야 하는 약의 복용 기록을 놓치지 않고 관리하고 싶다.
  * **Pain Points:**
      * 갑작스러운 발작에 경황이 없어, 발작 시간이나 양상을 정확히 기억하기 어렵다.
      * 과거 기록을 찾아보거나 정리하는 것이 번거롭다.
      * 아이의 상태에 대한 막연한 불안감을 느낀다.

### **Tertiary Agent: 의료진 (의사, 간호사)**

  * **Goals:**
      * 보호자의 주관적인 기억이 아닌, 객관적이고 정량화된 데이터를 바탕으로 진료하고 싶다.
      * 약물 변경 후 발작 빈도나 강도의 변화를 명확한 데이터로 확인하고 싶다.
      * 환자의 생활 습관과 발작의 상관관계를 파악하여 더 정확한 치료 가이드를 제공하고 싶다.
  * **Pain Points:**
      * 보호자의 부정확하거나 감정적인 설명에 의존하여 상태를 파악해야 한다.
      * 치료 효과를 판단하기 위한 장기적인 데이터가 부족하다.

\<br\>

## 3\. 핵심 기능 및 데이터 지표

### **A. 발작 기록 (Seizure Log)**

  * `발생 일시`: 날짜와 시간 (필수)
  * `지속 시간`: 스톱워치 기능으로 측정 (초/분 단위)
  * `발작 유형`: 객관식 선택 (예: 전신 발작, 초점 발작, 의식 소실 유무 등)
  * `전조 증상`: 발작 전 보인 특이 행동이나 느낌 기록 (태그 또는 텍스트)
  * `발작 후 상태`: 발작 종료 후 아이의 상태 (예: 깊은 잠, 혼란, 두통 등)
  * `동영상 첨부`: 발작 양상을 녹화하여 업로드 (Storage 연동)

### **B. 생활/건강 기록 (Lifestyle Log)**

  * `약물 복용`: 약 종류, 용량, 시간 기록 및 복용 여부 체크 (알림 기능 포함)
  * `수면 시간`: 취침 및 기상 시간 기록
  * `컨디션/감정`: 좋음/보통/나쁨 등 아이의 전반적인 상태 기록
  * `특이사항 (유발 요인)`: 예방접종, 고열, 스트레스 등 특별한 이벤트 메모

### **C. 통계 및 보고서 (Analytics & Report)**

  * `대시보드`: 월별 발작 횟수, 요일/시간대별 발생 패턴 시각화 (그래프)
  * `약물 순응도`: 설정된 계획 대비 실제 복용률(%) 표시
  * `상관관계 분석`: 수면 시간과 발작 발생 간의 관계 등 시각적 비교 데이터 제공
  * `보고서 생성`: 지정된 기간의 모든 기록을 PDF 파일로 생성하여 공유/출력하는 기능

\<br\>

## 4\. 사용자 시나리오 (Interaction Scenarios)

**Scenario 1: 아이가 발작을 일으켰을 때**

1.  보호자는 앱을 실행하고 '발작 기록하기' 버튼을 누른다.
2.  앱 내 스톱워치가 즉시 시작된다.
3.  보호자는 아이를 안정시키며 다른 손으로 발작 양상을 동영상으로 녹화한다.
4.  발작이 멈추면 스톱워치를 중지하고, 객관식으로 발작 유형과 발작 후 상태를 선택한다.
5.  간단한 메모와 함께 촬영한 동영상을 첨부하여 기록을 저장한다.

**Scenario 2: 병원 방문을 준비할 때**

1.  보호자는 '보고서' 탭으로 이동한다.
2.  지난번 방문일부터 오늘까지의 기간을 설정한다.
3.  'PDF로 내보내기' 버튼을 눌러 요약 리포트를 생성한다.
4.  생성된 보고서를 이메일로 병원에 미리 보내거나, 프린트하여 방문 시 지참한다.

**Scenario 3: 매일 밤 잠자리에 들기 전**

1.  오전에 받은 약물 복용 알림에 따라 '복용 완료' 버튼을 눌렀는지 확인한다.
2.  '생활 기록' 탭에서 아이가 잠든 시간을 기록하고, 그날의 컨디션을 간단히 체크한 후 앱을 종료한다.

\<br\>

## 5\. 기술 아키텍처 (Tech Stack)

  * **프론트엔드 (Web):** **Next.js (React)**
      * 반응형 UI/UX, SSR/SSG를 통한 빠른 로딩 속도 및 웹 접근성 확보
  * **백엔드 서비스:**
      * **Supabase (BaaS):**
          * **Auth:** 사용자 회원가입 및 로그인 처리
          * **PostgreSQL DB:** 모든 발작 및 생활 기록 데이터 저장
          * **Storage:** 동영상 파일 저장
          * **Realtime:** (향후) 보호자 간 커뮤니티 기능 등을 위한 실시간 데이터 동기화
      * **FastAPI (Python) API Server:**
          * 통계 데이터 생성, PDF 보고서 생성 등 복잡한 데이터 처리 및 연산을 위한 별도 API 서버
          * Supabase PostgreSQL DB에 직접 연결하여 데이터를 가공 처리함
  * **데이터 흐름:**
    1.  **Next.js 클라이언트**는 `supabase-js`를 통해 인증, 간단한 CRUD, 파일 업로드를 **Supabase**와 직접 통신한다.
    2.  통계, 보고서 등 복잡한 데이터 요청 시, **Next.js 클라이언트**는 **FastAPI 서버**의 엔드포인트를 호출한다.
    3.  **FastAPI 서버**는 Supabase DB에서 데이터를 조회 및 가공하여 결과를 클라이언트에 반환한다.

<br>

## 6. Python 환경 및 패키지 관리 (Python Environment & Package Management)

  * **Configuration:** `pyproject.toml`
      * PEP 621 기반의 표준화된 프로젝트 메타데이터 및 의존성 관리를 위해 `pyproject.toml` 파일을 사용한다.
      * 모든 프로젝트 설정(빌드, 포맷팅, 린팅 등)을 중앙에서 관리하여 일관성을 유지한다.
  * **Package Manager:** `uv`
      * Rust 기반의 고성능 Python 패키지 설치 및 관리 도구인 `uv`를 사용한다.
      * `pip` 및 `venv`를 대체하여 가상 환경 생성, 의존성 설치/제거/동기화 작업을 매우 빠른 속도로 처리한다.
      * `uv pip` 명령어를 통해 기존 `pip` 워크플로우와 호환성을 유지하면서도 성능을 극대화한다.